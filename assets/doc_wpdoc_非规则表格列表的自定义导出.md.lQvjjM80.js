import{_ as s,o as a,c as i,R as n}from"./chunks/framework.S1SDgkSw.js";const g=JSON.parse('{"title":"非规则表格列表的自定义导出","description":"","frontmatter":{"title":"非规则表格列表的自定义导出","date":"2021-10-09T11:22:41.000Z"},"headers":[],"relativePath":"doc/wpdoc/非规则表格列表的自定义导出.md","filePath":"doc/wpdoc/非规则表格列表的自定义导出.md"}'),t={name:"doc/wpdoc/非规则表格列表的自定义导出.md"},l=n(`<h3 id="一、背景介绍" tabindex="-1">一、背景介绍 <a class="header-anchor" href="#一、背景介绍" aria-label="Permalink to &quot;一、背景介绍&quot;">​</a></h3><p>适用于有需要用到导出<strong>非规则表格</strong>的项目。</p><p>需求：之前的通用导出只能支持导出规则的表格列表，不能支持导出非规则表格列表（合并行、合并列、设置行高、设置列宽、设置字体大小、颜色等）。</p><p>缺点：比较麻烦，比较费时，需定制化。</p><p>说明：该组件不可能被完全复用，因为非规则表格都是<strong>高度定制化</strong>的，内容、样式等因项目而异。该组件会从基础的自定义导出的API进行介绍，通过一个简单案例进行分析，会分享一些在使用过程中遇到的一些问题以及解决方法。让使用者了解自定义导出，快速上手进行开发，加快开发进度。</p><h3 id="二、规则表格和非规则表格的比较" tabindex="-1">二、规则表格和非规则表格的比较 <a class="header-anchor" href="#二、规则表格和非规则表格的比较" aria-label="Permalink to &quot;二、规则表格和非规则表格的比较&quot;">​</a></h3><h4 id="规则表格" tabindex="-1">规则表格 <a class="header-anchor" href="#规则表格" aria-label="Permalink to &quot;规则表格&quot;">​</a></h4><p>现在我们使用的大部分（99.9%）都是这样的规则的表格列表：</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D304.png" alt=""></p><p>导出功能：可以使用flycode导出、新导出（直接根据查询条件进行导出）。</p><h4 id="非规则表格" tabindex="-1">非规则表格 <a class="header-anchor" href="#非规则表格" aria-label="Permalink to &quot;非规则表格&quot;">​</a></h4><p>该页面大致可分上下两个表格，有一些合并行、合并列。</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D377.png" alt=""></p><p>导出功能：（上面提到的两种普通导出都不能实现）只能通过Excel-API操作进行导出。</p><h4 id="excel-api操作" tabindex="-1">Excel-API操作 <a class="header-anchor" href="#excel-api操作" aria-label="Permalink to &quot;Excel-API操作&quot;">​</a></h4><p>在开发者网站上面有相关的介绍和一些案例，位置：技术能力--&gt;Flycode手册--&gt;3.参考手册--&gt;3.4其他--&gt;3.4.5Excel-API操作。</p><p>详见：<a href="http://apaas.wxchina.com:8881/technology/380/" target="_blank" rel="noreferrer">http://apaas.wxchina.com:8881/technology/380/</a></p><p>注意：使用该API对一些服务的版本有一定的要求，详见：<a href="#header-n135">前提-各服务版本要求</a></p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D699.png" alt=""></p><h3 id="三、通用操作步骤-流程" tabindex="-1">三、通用操作步骤(流程) <a class="header-anchor" href="#三、通用操作步骤-流程" aria-label="Permalink to &quot;三、通用操作步骤(流程)&quot;">​</a></h3><p>开始套路，不管啥项目，都可以按照这个套路进行操作：</p><p>加载模块；</p><p>（预处理）定义一些需要用到的字体样式（基于单元格cell或者是行数据）：文字大小、字体、颜色、是否加粗、是否斜体、是否加删除线、是否加下划线、双下划线、是否自动换行、是否加边框、排列规则（居左、居中、居右）、背景颜色等；</p><p>添加sheet；</p><p>设计sheet：添加行、列；合并行、合并列、设置行高、设置列宽等；</p><p>导出。</p><h4 id="通用模板" tabindex="-1">通用模板 <a class="header-anchor" href="#通用模板" aria-label="Permalink to &quot;通用模板&quot;">​</a></h4><p>按照上面的步骤，我归纳了核心代码</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//自定义导出</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 1.加载模块</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">load</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;excelapi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 2.字体样式（预处理，最多不能超过 30 种类型）*  /</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/ * 样式默认</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">名称  样式简述</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">default 默认数据行样式（不加粗、字号14、宋体）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">title   默认标题行样式（加粗、字号24、宋体） </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">*/</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> style </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;14&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//文字大小，默认 14</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.fontname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;宋体&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//宋体，默认 宋体</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.fontcolor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;black&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//颜色，默认 黑色</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.bold </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//加粗，默认 false, true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.italic </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//斜体，默认 false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.strikeout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//删除线，默认 false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.underline </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//下划线，默认 false，有3个可选值：false,true,2 (如果需要使用双下划线，那么就赋值2)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.wrap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//自动换行，默认 false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.border </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//边框，默认 false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.align </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;center&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//水平对齐规则，默认 center，居左 left、居中 center、居右 right</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.verticalAlign </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;center&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//垂直对齐规则，默认 center，居上 top、居中 center、居下 bottom</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.wrap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//自动换行，默认 false</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//style.backcolor = &#39;white&#39;;    //背景色，默认 白色 （暂时发现如果设置白色有bug，会变成黑色）</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EXCEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addStyle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;样式1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, style);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 也可以只设置需要的属性，其余用默认的</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> style </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;14&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;              </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//文字大小，默认 14</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.bold </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;true&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//加粗，默认 false, true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.border </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;true&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//边框，默认 false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EXCEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addStyle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;默认大小加粗加边框&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, style);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 3.添加sheet</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sheet </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EXCEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addSheet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;经销商考核表&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 4.设计sheet</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 进度条操作总数 setTotalCount,进度条的更新状态是根据 （操作完成数/操作总数=进度条的进度）。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 假设表格20行</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EXCEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTotalCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 添加行（第一行）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> row </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sheet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addRow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 设置该行行高为 30</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">row.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setHigh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 添加列（第一行第一列，即第一行第一个单元格）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">row.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addCell</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;经销商考核表&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;样式1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 合并单元格：开始行、结束行、开始列、结束列</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sheet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">merge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;0,0,0,7&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//合并开始行为第1行，结束行下标为1的行，开始列第1列，结束列第8列的单元格。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> row </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sheet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addRow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">row.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addCell</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;这是第二行第一列的单元格&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;样式1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sheet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">merge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;1,2,0,10&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//设置列宽，第一列列宽为 50</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sheet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setCellWidth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 5.导出</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EXCEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;经销商考核详情&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><p>详见：自定义导出-通用模板</p><p>效果图：</p><p>第一行：合并1-8个单元格（A1-H1），即合并了1行8列；设置行高位30。</p><p>第二行：合并A2-K3，即合并了2行11列。</p><p>设置第一列列宽为 50。</p><p>导出效果中的“成功导出数据”条数，即为设置的setTotalCount值。</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D2652.png" alt=""></p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D2655.png" alt=""></p><h3 id="四、excel-api简介" tabindex="-1">四、Excel-API简介 <a class="header-anchor" href="#四、excel-api简介" aria-label="Permalink to &quot;四、Excel-API简介&quot;">​</a></h3><p>简单介绍一些比较重要的API。</p><p>其实主要的核心代码都在上面介绍的通用模板里面了，这里主要补充介绍一些可能会用到的其他功能。</p><h4 id="_1-字体样式定义" tabindex="-1">1.字体样式定义 <a class="header-anchor" href="#_1-字体样式定义" aria-label="Permalink to &quot;1.字体样式定义&quot;">​</a></h4><p>大部分属性都在这里了（大部分和office里面操作Excel的属性一致，但是不保证该API在开发者网站上面介绍的功能都能<strong>实现</strong>，因为好像之前比较少项目用到了这个功能，后续也没有进行一些功能的优化和bug的修复）。</p><h5 id="_1-基本属性" tabindex="-1"><strong>1）基本属性</strong> <a class="header-anchor" href="#_1-基本属性" aria-label="Permalink to &quot;**1）基本属性**&quot;">​</a></h5><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 2.字体样式（预处理，最多不能超过 30 种类型） */</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 样式默认</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">名称  样式简述</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">default 默认数据行样式（不加粗、字号14、宋体）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">title   默认标题行样式（加粗、字号24、宋体） </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">*/</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> style </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;14&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//文字大小，默认 14</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.fontname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;宋体&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;        </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//宋体，默认 宋体</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.fontcolor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;black&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//颜色，默认 黑色</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.bold </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//加粗，默认 false, true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.italic </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//斜体，默认 false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.strikeout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//删除线，默认 false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.underline </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//下划线，默认 false，有3个可选值：false,true,2 (如果需要使用双下划线，那么就赋值2)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.wrap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//自动换行，默认 false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.border </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//边框，默认 false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.align </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;center&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//水平对齐规则，默认 center，居左 left、居中 center、居右 right</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.verticalAlign </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;center&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//垂直对齐规则，默认 center，居上 top、居中 center、居下 bottom</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">style.wrap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;false&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//自动换行，默认 false</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//style.backcolor = &#39;white&#39;;    //背景色，默认 白色 （暂时发现如果设置白色有bug，会变成黑色）</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EXCEL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addStyle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;样式1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, style);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>补充一下：</p><h5 id="_2-边框线颜色-bordercolor" tabindex="-1"><strong>2）边框线颜色 bordercolor：</strong> <a class="header-anchor" href="#_2-边框线颜色-bordercolor" aria-label="Permalink to &quot;**2）边框线颜色 bordercolor：**&quot;">​</a></h5><table><thead><tr><th>属性值</th><th>描述</th></tr></thead><tbody><tr><td>red <strong>或者</strong> 10</td><td>红色</td></tr><tr><td>blue <strong>或者</strong> 12</td><td>蓝色</td></tr><tr><td>orange <strong>或者</strong> 53</td><td>橙色</td></tr><tr><td>black <strong>或者</strong> 8</td><td>黑色</td></tr><tr><td>white <strong>或者</strong> 9</td><td>白色</td></tr><tr><td>green <strong>或者</strong> 17</td><td>绿色</td></tr><tr><td>yellow <strong>或者</strong>13</td><td>黄色</td></tr><tr><td>pink<strong>或者</strong>14</td><td>粉色</td></tr><tr><td>violet <strong>或者</strong>20</td><td>紫色</td></tr></tbody></table><h5 id="_3-背景色-backcolor" tabindex="-1"><strong>3）背景色 backcolor：</strong> <a class="header-anchor" href="#_3-背景色-backcolor" aria-label="Permalink to &quot;**3）背景色 backcolor：**&quot;">​</a></h5><table><thead><tr><th>属性值</th><th>描述</th></tr></thead><tbody><tr><td>red <strong>或者</strong> 10</td><td>红色</td></tr><tr><td>blue <strong>或者</strong> 12</td><td>蓝色</td></tr><tr><td>orange <strong>或者</strong> 53</td><td>橙色</td></tr><tr><td>black <strong>或者</strong> 8</td><td>黑色</td></tr><tr><td>white <strong>或者</strong> 9</td><td>白色</td></tr><tr><td>green <strong>或者</strong> 17</td><td>绿色</td></tr><tr><td>yellow <strong>或者</strong>13</td><td>黄色</td></tr><tr><td>pink<strong>或者</strong>14</td><td>粉色</td></tr><tr><td>gold<strong>或者</strong>51</td><td>金色</td></tr></tbody></table><h4 id="_2-进度条操作" tabindex="-1"><em><strong>*2.进度条操作*</strong></em> <a class="header-anchor" href="#_2-进度条操作" aria-label="Permalink to &quot;***\\*2.进度条操作\\****&quot;">​</a></h4><h5 id="_1-进度条操作总数-settotalcount" tabindex="-1"><strong>1) 进度条操作总数</strong> <em><strong>*setTotalCount*</strong></em> <a class="header-anchor" href="#_1-进度条操作总数-settotalcount" aria-label="Permalink to &quot;**1) 进度条操作总数** ***\\*setTotalCount\\****&quot;">​</a></h5><p>导出后显示的导出记录条数就是这个值。</p><p>进度条的更新状态是根据 （操作完成数/操作总数=进度条的进度）。</p><p>EXCEL.setTotalCount(100);</p><h5 id="_2-更新进度条进度-updatestate" tabindex="-1"><strong>2) 更新进度条进度</strong> <em><strong>*updateState*</strong></em> <a class="header-anchor" href="#_2-更新进度条进度-updatestate" aria-label="Permalink to &quot;**2) 更新进度条进度** ***\\*updateState\\****&quot;">​</a></h5><p>EXCEL.updateState(20);<em>//结合上面setTotalCount的样例，就是当前已经完成20.也就是20/100,进度条更新到20%的状态</em></p><p>注意一下，如果逻辑执行速度快的话，这里其实是无感的，即会一闪而逝。但是如果数据量比较大，执行比较慢，这个设置就是比较必要的。</p><h5 id="_3-操作过程可能存在问题更新进度条失败状态-error" tabindex="-1"><strong>3) 操作过程可能存在问题更新进度条失败状态</strong> <em><strong>*error*</strong></em> <a class="header-anchor" href="#_3-操作过程可能存在问题更新进度条失败状态-error" aria-label="Permalink to &quot;**3) 操作过程可能存在问题更新进度条失败状态** ***\\*error\\****&quot;">​</a></h5><p>EXCEL.error(&quot;xxxx数据不能为空&quot;);<em>//更新进度条状态为失败状态，并记录&quot;xxxx数据不能为空&quot;的异常日志</em></p><h4 id="_3-合并单元格" tabindex="-1"><em><strong>*3.合并单元格*</strong></em> <a class="header-anchor" href="#_3-合并单元格" aria-label="Permalink to &quot;***\\*3.合并单元格\\****&quot;">​</a></h4><p>包括合并行和合并列，但是这里是统一处理，其实就是<strong>画矩形</strong>，把圈中的单元格进行合并。</p><p>注意一下：如果需要设置边框的话，需要为空白单元格也设置边框，不然会合并后边框会不全。</p><p><em>// 合并单元格：开始行、结束行、开始列、结束列</em><br> sheet.merge(&#39;0,0,0,7&#39;);<em>//合并开始行为第1行，结束行下标为1的行，开始列第1列，结束列第8列的单元格。</em><br><strong>var</strong> row = sheet.addRow(1);<br> row.addCell(0,&quot;这是第二行第一列的单元格&quot;,&quot;样式1&quot;)<br> sheet.merge(&#39;1,2,0,10&#39;);<em>//合并开始行为第2行，结束行下标为3的行，开始列第1列，结束列第11列的单元格。</em></p><h3 id="五、前提-各服务版本要求" tabindex="-1">五、前提-各服务版本要求 <a class="header-anchor" href="#五、前提-各服务版本要求" aria-label="Permalink to &quot;五、前提-各服务版本要求&quot;">​</a></h3><p>这个在开发者平台的文章中并没有介绍，但是确是必不可少的。</p><p>我当时是直接把里面的案例1拷贝到IDE中进行测试，然后行不通，一脸懵逼。之后请教平台开发人员，他们只说是看服务版本是否符合要求，至于具体哪个版本并没有说清楚，让我自己去看开发者网站上面这个功能的发版时间，一脸懵，不过聊胜于无……</p><p>然而实际上，发版日志好像也没有找到“自定义导出”的字眼，只有类似的“新导入导出”，虽然有一定差别，但是我猜测就是一同发布的，然后去跟踪相关的服务版本。</p><p><a href="http://apaas.wxchina.com:8881/" target="_blank" rel="noreferrer">http://apaas.wxchina.com:8881/</a></p><p>直接在开发者平台的首页可以看到各服务版本介绍，按照需要去找对应的服务版本。</p><h4 id="导入导出服务" tabindex="-1">导入导出服务 <a class="header-anchor" href="#导入导出服务" aria-label="Permalink to &quot;导入导出服务&quot;">​</a></h4><p><a href="http://apaas.wxchina.com:8881/2020/05/25/impexp/" target="_blank" rel="noreferrer">http://apaas.wxchina.com:8881/2020/05/25/impexp/</a></p><p>使用【新导入导出】，含进度条，需升级此服务到2.8.1及以上，同时web端需要更新到9.2.0及以上，才可以正常显示进度条，及取消功能。</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D5101.png" alt=""></p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D5104.png" alt=""></p><h4 id="队列服务" tabindex="-1">队列服务 <a class="header-anchor" href="#队列服务" aria-label="Permalink to &quot;队列服务&quot;">​</a></h4><p><a href="http://apaas.wxchina.com:8881/2020/05/25/queueserv/" target="_blank" rel="noreferrer">http://apaas.wxchina.com:8881/2020/05/25/queueserv/</a></p><p>使用【新导入导出】，含进度条，需升级此服务到2.8.1及以上，同时web端需要更新到9.2.0及以上，才可以正常显示进度条，及取消功能</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D5232.png" alt=""></p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D5235.png" alt=""></p><h4 id="web服务" tabindex="-1">web服务 <a class="header-anchor" href="#web服务" aria-label="Permalink to &quot;web服务&quot;">​</a></h4><p><a href="http://apaas.wxchina.com:8881/2020/05/25/web/" target="_blank" rel="noreferrer">http://apaas.wxchina.com:8881/2020/05/25/web/</a></p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D5290.png" alt=""></p><h4 id="各服务版本最低要求" tabindex="-1">各服务版本最低要求 <a class="header-anchor" href="#各服务版本最低要求" aria-label="Permalink to &quot;各服务版本最低要求&quot;">​</a></h4><p>按照上面分析我们可以得到需要的最低版本如下：</p><table><thead><tr><th>服务名称</th><th>版本</th><th>发版日期</th></tr></thead><tbody><tr><td>impexp</td><td>v2.8.1</td><td>2020.9.17</td></tr><tr><td>queueserv</td><td>v2.8.1</td><td>2020.9.17</td></tr><tr><td>web</td><td>v9.2.1</td><td>2020.10.19</td></tr></tbody></table><h4 id="查看服务器中各服务版本" tabindex="-1">查看服务器中各服务版本 <a class="header-anchor" href="#查看服务器中各服务版本" aria-label="Permalink to &quot;查看服务器中各服务版本&quot;">​</a></h4><p>如果各服务是按照我们统一的规范来部署的话，服务的安装的位置应该是一致的，直接运行下面的命令即可查看服务版本。</p><p>如果报错了（找不到文件），可能是安装位置不一样，那么就需要先找到安装位置（如： find / <em>impexp</em>），再查看服务版本（gitInfo.json）。</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>#查看 impexp 服务版本</span></span>
<span class="line"><span>grep -A 4 impexp-service /home/apaas/impexp/gitInfo.json</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 查看 queue-service 服务版本</span></span>
<span class="line"><span>grep -A 4 queue-service /home/apaas/backend/apache-tomcat/gitinfo/queueserv/gitInfo.json</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 查看 web 服务版本</span></span>
<span class="line"><span>grep -A 4 WebApp /home/apaas/web/gitInfo.json</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>我的测试环境的相关版本：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">root@iZwz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">avhtjzlfkk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">gg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">Z</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> queueserv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# grep -A </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> impexp-service /home/apaas/impexp/gitInfo.json</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;impexp-service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;bracnh&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;v2.8.4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;commitId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;4ce686e74b8f532b095220f32fe45558a1c91854&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://172.16.0.141/aPaaS-BizEngine/ImportExportService.git&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">root@iZwz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">avhtjzlfkk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">gg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">Z</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> queueserv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# grep -A </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> queue-service /home/apaas/backend/apache-tomcat/gitinfo/queueserv/gitInfo.json</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;queue-service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;bracnh&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;v2.8.4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;commitId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;476244c68b0c38dd63f5a02e5cc505b7e090e6f7&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://172.16.0.141/aPaaS-BizEngine/QueueService.git&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">root@iZwz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">avhtjzlfkk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">gg</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">Z</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> queueserv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# grep -A </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WebApp /home/apaas/web/gitInfo.json</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;WebApp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;bracnh&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;V9.2.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;commitId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;d0eb6d23e745a674451384ee85ab8a8f16fb44ca&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://172.16.0.141/K100-Web/WebApp.git&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;XtionWebEngine&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;bracnh&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;V9.2.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;commitId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;63d019f0581aff8b7a1e60b6190efa829a0fc40f&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="六、开发" tabindex="-1">六、开发 <a class="header-anchor" href="#六、开发" aria-label="Permalink to &quot;六、开发&quot;">​</a></h3><h4 id="web端页面设计" tabindex="-1">web端页面设计 <a class="header-anchor" href="#web端页面设计" aria-label="Permalink to &quot;web端页面设计&quot;">​</a></h4><p>以该页面进行分析</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D6860.png" alt=""></p><p>1.页面类型：自由布局</p><p>2.页面结构：分为上下两个表格，1.自由布局，一个一个配。2.表格列表。3.合并列配置。</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D6920.png" alt=""></p><p>合并列配置（需要保证合并列的数据（文字）是一致的，不然会无效）：</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D6956.png" alt=""></p><h4 id="业务行为编写" tabindex="-1">业务行为编写 <a class="header-anchor" href="#业务行为编写" aria-label="Permalink to &quot;业务行为编写&quot;">​</a></h4><p>1.新建业务行为，选择业务行为类型：<strong>flycode导出</strong>。</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D6995.png" alt=""></p><p>2.设置输入参数，注意需要和普通导出一样，必需要有<strong>导出的filename</strong>和<strong>导出的sheetname</strong>这两个属性。</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D7054.png" alt=""></p><p>3.编写逻辑</p><p>上面写查询逻辑，下面导出逻辑。将查询的结果嵌套到导出逻辑即可。</p><h3 id="七、案例使用步骤" tabindex="-1">七、案例使用步骤 <a class="header-anchor" href="#七、案例使用步骤" aria-label="Permalink to &quot;七、案例使用步骤&quot;">​</a></h3><h4 id="_1-导入目录" tabindex="-1">1.导入目录 <a class="header-anchor" href="#_1-导入目录" aria-label="Permalink to &quot;1.导入目录&quot;">​</a></h4><p>IDE--配置管理--目录导入导出--导入文件夹“Step-0：目录配置”中的文件。</p><h4 id="_2-导入实体和数据" tabindex="-1">2.导入实体和数据 <a class="header-anchor" href="#_2-导入实体和数据" aria-label="Permalink to &quot;2.导入实体和数据&quot;">​</a></h4><p>IDE--业务实体--导入文件夹“Step-1：业务实体配置/3-实体对象配置”中的文件；</p><p>数据库执行脚本，生成表数据，脚本位于“Step-1：业务实体配置/2-业务实体脚本-数据”。</p><h4 id="_3-导入业务领域" tabindex="-1">3.导入业务领域 <a class="header-anchor" href="#_3-导入业务领域" aria-label="Permalink to &quot;3.导入业务领域&quot;">​</a></h4><p>IDE--业务领域--导入文件夹“Step-2：业务领域配置/1-业务行为代码”中的文件。</p><h4 id="_4-导入业务ui" tabindex="-1">4.导入业务UI <a class="header-anchor" href="#_4-导入业务ui" aria-label="Permalink to &quot;4.导入业务UI&quot;">​</a></h4><p>（1）IDE--业务UI--导入文件夹“Step-3：业务UI配置/1-业务UI”中的文件。</p><p>（2）配置功能权限（参考“Step-3：业务UI配置/2-功能权限配置”的图例）。</p><h3 id="八、案例效果图" tabindex="-1">八、案例效果图 <a class="header-anchor" href="#八、案例效果图" aria-label="Permalink to &quot;八、案例效果图&quot;">​</a></h3><h4 id="详情页面-经销商考核表详情-案例" tabindex="-1">详情页面-经销商考核表详情-案例 <a class="header-anchor" href="#详情页面-经销商考核表详情-案例" aria-label="Permalink to &quot;详情页面-经销商考核表详情-案例&quot;">​</a></h4><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D7432.png" alt=""></p><h4 id="导出案例页面-自定义导出案例" tabindex="-1">导出案例页面-自定义导出案例 <a class="header-anchor" href="#导出案例页面-自定义导出案例" aria-label="Permalink to &quot;导出案例页面-自定义导出案例&quot;">​</a></h4><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D7450.png" alt=""></p><h4 id="自定义导出-通用模板" tabindex="-1">自定义导出-通用模板 <a class="header-anchor" href="#自定义导出-通用模板" aria-label="Permalink to &quot;自定义导出-通用模板&quot;">​</a></h4><p>这是最简单的通用模板（代码模板）</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D7481.png" alt=""></p><h4 id="经销商考核表详情-案例1" tabindex="-1">经销商考核表详情-案例1 <a class="header-anchor" href="#经销商考核表详情-案例1" aria-label="Permalink to &quot;经销商考核表详情-案例1&quot;">​</a></h4><p>经销商考核表详情的一种导出模板：计算数据加粗、加边框</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D7524.png" alt=""></p><h4 id="经销商考核表详情-案例2" tabindex="-1">经销商考核表详情-案例2 <a class="header-anchor" href="#经销商考核表详情-案例2" aria-label="Permalink to &quot;经销商考核表详情-案例2&quot;">​</a></h4><p>经销商考核表详情的一种导出模板：计算数据加粗、加边框，加黄色背景</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D7573.png" alt=""></p><h4 id="经销商考核表详情-案例3" tabindex="-1">经销商考核表详情-案例3 <a class="header-anchor" href="#经销商考核表详情-案例3" aria-label="Permalink to &quot;经销商考核表详情-案例3&quot;">​</a></h4><p>经销商考核表详情的一种导出模板：整体加边框</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D7611.png" alt=""></p><h4 id="经销商考核表详情-案例4" tabindex="-1">经销商考核表详情-案例4 <a class="header-anchor" href="#经销商考核表详情-案例4" aria-label="Permalink to &quot;经销商考核表详情-案例4&quot;">​</a></h4><p>经销商考核表详情的一种导出模板：优化整体布局，对齐数据列，计算数据加粗</p><p><img src="http://apaas.wxchina.com:8881/wp-content/uploads/%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D7663.png" alt=""></p><h3 id="九、经验分享" tabindex="-1">九、经验分享 <a class="header-anchor" href="#九、经验分享" aria-label="Permalink to &quot;九、经验分享&quot;">​</a></h3><p>1.因为使用该API需要自己计算行数和列数，因此需要明白行列的数组下标但是从0开始的。</p><p>2.合并行如果需要设置边框的话，需要将无数据的单元格也设置边框，不然边框会不全。</p><p>相关文件下载：<br><a href="http://apaas.wxchina.com:8881/wp-content/uploads/COM-BC024-FC001-%E9%9D%9E%E8%A7%84%E5%88%99%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E5%87%BA.zip" title="COM-BC024-FC001 非规则表格列表的自定义导出" target="_blank" rel="noreferrer">COM-BC024-FC001 非规则表格列表的自定义导出</a></p>`,142),p=[l];function e(h,k,r,E,d,o){return a(),i("div",null,p)}const A=s(t,[["render",e]]);export{g as __pageData,A as default};
